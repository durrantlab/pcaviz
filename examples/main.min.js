var l=function(){function c(a){this.u=this.f=void 0;this.s=[];this.i=this.j=void 0;this.m=[];this.S=void 0;this.b={};this.io=new e(this);this.H(a);void 0!==a.viewer&&(this.viewer=new g(this),this.player=new h(this))}c.prototype.H=function(a){this.b=jQuery.extend({viewer:void 0,viewerType:void 0,durationInMilliseconds:1E4,updateFreqInMilliseconds:10,loop:!0,windowAverageSize:1,parent:this},this.b,a);this.b.halfWindowSize=Math.floor((this.b.windowAverageSize-1)/2);if(void 0===this.b.visStyle)switch(this.b.viewerType){case "3DMOLJS":this.b.visStyle=
{line:{}};break;case "NGL":this.b.visStyle=void 0;break;case "JSMOL":this.b.visStyle=void 0}};c.prototype.C=function(a){var b=this;a=k.w(a-this.b.halfWindowSize,a+this.b.halfWindowSize+1);var d=a.map(function(a){0>a&&(a+=b.f);a%=b.f;return b.s[a]}).map(function(a){var d=b.m.map(function(d,b){return k.D(a[b],d)});return k.F(d)}).reduce(function(a,d){return k.F([a,d])}),c=k.D(1/a.length,d);return k.w(0,this.i/3).map(function(a){return new Float32Array([c[a],c[a+1],c[a+2]])})};return c}(),e=function(){function c(a){this.a=
a}c.prototype.loadJSON=function(a,b){var d=this;void 0===b&&(b=function(){});jQuery.getJSON(a,function(a){d.a.f=a.frames.length;d.a.u=a.frames[0].length;d.a.s=[];d.a.j=a.vectors.length;d.a.i=a.vectors[0].length;d.a.m=[];d.a.S=new Float32Array(d.a.j*d.a.i);if(d.a.u!==d.a.j)throw Error("The number of coefficients per frame "+("("+d.a.u+") is not the same")+("as the number of components ("+d.a.j+")"));for(var b in a.frames)a.frames.hasOwnProperty(b)&&(d.a.s[b]=new Float32Array(a.frames[b]));for(b in a.vectors)a.vectors.hasOwnProperty(b)&&
(d.a.m[b]=new Float32Array(a.vectors[b]))}).done(function(){b()}).fail(function(){console.log("error")})};c.prototype.makePDB=function(){for(var a=this.a.i/3,b="",d=0;d<this.a.f;d++){b+="MODEL "+d.toString()+"\n";for(var c=0;c<a;c++){var f=this.a.U(d,c);b+="ATOM  "+this.A(5,c.toString())+"  X   XXX X 852    "+this.o(f[0])+this.o(f[1])+this.o(f[2])+"  1.00  0.00           X  \n"}b+="ENDMDL\n"}return b};c.prototype.o=function(a){return this.A(8,a.toFixed(3))};c.prototype.A=function(a,b){var d;for(void 0===
d&&(d=" ");b.length<a;)b=d+b;return b};return c}(),g=function(){function c(a){this.c=void 0;this.v=!1;this.g=this.l=void 0;this.a=a;if(void 0===this.a.b.viewer)throw Error("No viewer specified!");if(void 0===this.a.b.viewerType)throw Error("No viewer type specified!");a=["3DMOLJS","NGL","JSMOL"];if(-1===a.indexOf(this.a.b.viewerType))throw Error("Specified viewer type, "+this.a.b.viewerType+", is invalid. Must be one of "+a.join("/"));switch(this.a.b.viewerType){case "3DMOLJS":this.addPDBTxt=this.I;
this.l=this.K;this.g=this.J;break;case "NGL":this.addPDBTxt=this.O;this.l=this.R;this.g=this.P;break;case "JSMOL":this.addPDBTxt=this.L;this.l=this.N;this.g=this.M;break;default:throw Error("Invalid viewer type specified: "+this.a.b.viewerType);}}c.prototype.G=function(a){this.v||(this.v=!0,this.l(a),this.v=!1,this.g())};c.prototype.I=function(a){this.c=this.a.b.viewer.addModel(a,"pdb");this.g()};c.prototype.K=function(a){a=this.a.C(a);for(var b=this.c.selectedAtoms({}),d=0;d<b.length;d++){var c=
a[d];b[d].x=c[0];b[d].y=c[1];b[d].z=c[2]}};c.prototype.J=function(){this.c.setStyle({},this.a.b.visStyle);this.a.b.viewer.render()};c.prototype.O=function(a){var b=this;this.a.b.viewer.V(new Blob([a],{type:"text/plain"}),{ext:"pdb",T:!0}).then(function(a){b.c=a})};c.prototype.R=function(a){var b=this.a.C(a),d=0;this.c.structure.eachAtom(function(a){var c=b[d];a.x=c[0];a.y=c[1];a.z=c[2];d++})};c.prototype.P=function(){this.c.rebuildRepresentations()};c.prototype.L=function(){var a=this;setTimeout(function(){console.log('load data "model example"\nATOM     30  X   XXX X 852       1.020  -0.246  -0.345  1.00  0.00           X\nATOM     31  X   XXX X 852      -1.570   0.836  -0.115  1.00  0.00           X\nATOM     32  X   XXX X 852       0.000  -0.738   0.207  1.00  0.00           X\nATOM     33  X   XXX X 852       0.785  -0.344   0.069  1.00  0.00           X\nATOM     34  X   XXX X 852      -1.727  -0.246   0.253  1.00  0.00           X\nATOM     35  X   XXX X 852      -0.157  -0.197   0.000  1.00  0.00           X\nATOM     36  X   XXX X 852       0.549   0.984  -0.391  1.00  0.00           X\nATOM     37  X   XXX X 852       0.471   0.295   0.138  1.00  0.00           X\nend "model example";');
a.a.b.viewer.library.W(a.a.b.viewer.applet,'load data "model example"\nATOM     30  X   XXX X 852       1.020  -0.246  -0.345  1.00  0.00           X\nATOM     31  X   XXX X 852      -1.570   0.836  -0.115  1.00  0.00           X\nATOM     32  X   XXX X 852       0.000  -0.738   0.207  1.00  0.00           X\nATOM     33  X   XXX X 852       0.785  -0.344   0.069  1.00  0.00           X\nATOM     34  X   XXX X 852      -1.727  -0.246   0.253  1.00  0.00           X\nATOM     35  X   XXX X 852      -0.157  -0.197   0.000  1.00  0.00           X\nATOM     36  X   XXX X 852       0.549   0.984  -0.391  1.00  0.00           X\nATOM     37  X   XXX X 852       0.471   0.295   0.138  1.00  0.00           X\nend "model example";')},
1E3)};c.prototype.N=function(){};c.prototype.M=function(){};return c}(),h=function(){function c(a){this.h=this.B=void 0;this.a=a}c.prototype.start=function(a){var b=this;this.B=(new Date).getTime();this.a.H(a);void 0!==this.h&&clearInterval(this.h);this.h=setInterval(function(){var a=((new Date).getTime()-b.B)/b.a.b.durationInMilliseconds;!b.a.b.loop&&1<a?b.stop():b.a.viewer.G(Math.floor(b.a.f*a))},this.a.b.updateFreqInMilliseconds)};c.prototype.stop=function(){void 0!==this.h&&clearInterval(this.h)};
c.prototype.toFrame=function(a){this.a.viewer.G(a)};return c}(),k;(function(c){c.w=function(a,b){for(var d=[];a<b;)d.push(a),a++;return d};c.F=function(a){return 1===a.length?a[0]:a.reduce(function(a,d){return a.map(function(a,b){return a+d[b]})})};c.D=function(a,b){switch(a){case 0:return new Float32Array(b.length);case 1:return b;default:return b.map(function(b){return a*b})}}})(k||(k={}));window.BrowserSim=l;
